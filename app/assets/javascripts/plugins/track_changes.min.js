/*!
 * froala_editor v3.2.3 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2021 Froala Labs
 */

!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("froala-editor")):"function"==typeof define&&define.amd?define(["froala-editor"],t):t(e.FroalaEditor)}(this,function(O){"use strict";function V(e){return function t(e){if(Array.isArray(e))return i(e)}(e)||function a(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function n(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return i(e,t)}(e)||function r(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}O=O&&O.hasOwnProperty("default")?O["default"]:O,Object.assign(O.DEFAULTS,{trackChangesEnabled:!1,showChangesEnabled:!1}),O.PLUGINS.track_changes=function(y){var E=y.$,o=[],A="",_="",x="",M="",g=[],i=[],d=null;function c(){return o.pop()}function h(e){var t=!(!e||8!=e.keyCode),a=!(!e||46!=e.keyCode);if(y.opts.trackChangesEnabled){y.selection.restore();var n=y.selection.ranges(0).startContainer,r=E(n).parentsUntil(y.$el,"[data-tracking=true]");if(E(n).data("tracking")&&t)return void y.selection.clear();if(!r.length||"TD"==n.tagName){if(y.selection.isCollapsed()){y.markers.insert();var i=y.$el.find(".fr-marker");if(!i.length)return;var s="pending-".concat(y.id,"-").concat(y.track_changes.getPendingChanges().length),l=y.opts.showChangesEnabled?'class="fr-highlight-change"':"";if(t||a){if(t){for(;E(i[0].previousSibling).data("tracking");)i.insertBefore(i.prev());E(i[0].previousSibling).find("[data-tracking=true]").length&&i.insertBefore(E(i[0].previousSibling).find("[data-tracking=true]").eq(0))}else E(n).data("tracking")&&i.insertBefore(n.nextSibling),w(i);var o=i[0]&&i[0].previousSibling?i[0].previousSibling.nodeValue:"",c=o&&o.slice(0,-(e.selectionLength?e.selectionLength:1));a&&(i[0].nextSibling&&"SPAN"!==i[0].nextSibling.tagName&&null===i[0].nextSibling.nodeValue&&i[0].nextSibling.firstChild&&i[0].nextSibling.firstChild.before(i[0]),c=(o=i[0].nextSibling?i[0].nextSibling.nodeValue:" ")&&o.slice(1));var g,d=E('<span data-tracking="true" data-track-id="'.concat(s,'" ').concat(l,"></span>")),h=E('<span data-tracking-deleted="true" class="fr-tracking-deleted" contenteditable="false"></span>');y.opts.showChangesEnabled||h.addClass("fr-track-hide");var f=!1,p=!1;if(t)try{var u=i[0]&&i[0].previousSibling;i[0]&&i[0].previousElementSibling&&"I"===i[0].previousElementSibling.tagName&&!o&&(g=i[0].previousElementSibling),u&&3===u.nodeType&&"SPAN"!==u.parentNode.tagName&&u.previousSibling&&"SPAN"===u.previousSibling.tagName&&" "===u.nodeValue?g=u.previousSibling:u&&"SPAN"===u.parentNode.tagName&&0<E(u.parentNode).find(".fr-emoticon").length?(g=u.parentNode,f=!0):!u||"SPAN"!==u.tagName&&"HR"!==u.tagName?E(i).parent().prev().is("hr")&&(g=E(i).parent().prev().get(0),f=p=!0):g=u,f?(E(i[0].parentNode).after(d),p?E(i).parent().remove():E(i).remove()):i[0]?E(i).before(d):E(M).before(d)}catch(e){M&&E(M).before(d)}else if(a){var k=i[0].nextSibling;i[0].nextElementSibling&&"I"===i[0].nextElementSibling.tagName&&!i[0].nextSibling.nodeValue?g=i[0].nextElementSibling:k&&3===k.nodeType&&"SPAN"!==k.parentNode.tagName&&k.nextSibling&&"SPAN"===k.nextSibling.tagName&&" "===k.nodeValue?g=k.nextSibling:k&&"SPAN"===k.parentNode.tagName&&0<E(k.parentNode).find(".fr-emoticon").length?(g=k.parentNode,f=!0):k&&"SPAN"===k.tagName&&(g=k),f?(E(i[0].parentNode).before(d),E(i).remove()):E(i).after(d)}if(E(d).prepend(h),!g&&(g=o&&o.replace(c,""),y.helpers.isMobile()&&A)){var C=y.selection.get().focusNode,m=y.selection.get().focusOffset,b=1;_&&C&&_.isSameNode(C)&&(b=x-m),g=A.replace(/\u00a0/g," ").replace(o.replace(/\u00a0/g," "),"").slice(0,b)}if(g&&(f?(E(h).append(E(E(g).get(0).outerHTML)),y.markers.insert()):E(h).append(g)),g&&0==g.length)return;y.browser.msie&&t&&(E(d).prepend("".concat(O.MARKERS)),E(d).append("".concat(O.MARKERS))),t&&c&&i[0].previousSibling?i[0].previousSibling.nodeValue=c:a&&(E(d).append("".concat(O.MARKERS)),i[0].nextSibling.nodeValue=c)}else{var v=O.INVISIBLE_SPACE;y.helpers.isMobile()&&((v=i[0]&&i[0].previousSibling&&i[0].previousSibling.nodeValue?i[0].previousSibling.nodeValue.slice(-1):O.INVISIBLE_SPACE)&&i[0]&&i[0].previousSibling&&i[0].previousSibling.nodeValue?i[0].previousSibling.nodeValue=i[0].previousSibling.nodeValue.slice(0,-1):!i[0]||i[0].previousSibling||i[0].nextSibling||v!==O.INVISIBLE_SPACE||(v=y.selection.get().focusNode.nodeValue.slice(x,y.selection.get().focusOffset),y.selection.get().focusNode.nodeValue=y.selection.get().focusNode.nodeValue.slice(y.selection.get().focusOffset))),i.replaceWith('<span data-tracking="true" data-track-id="'.concat(s,'" ').concat(l,">").concat(v+O.MARKERS,"</span>"))}y.selection.restore(),y.track_changes.pushChange(s)}else{y.selection.save();var S=y.$el.find('.fr-marker[data-type="true"]').length&&y.$el.find('.fr-marker[data-type="true"]').get(0),N=y.$el.find('.fr-marker[data-type="false"]').length&&y.$el.find('.fr-marker[data-type="false"]').get(0);E(S).parent().hasClass("fr-emoticon")&&E(S).parent().before(S),L(S,N),y.selection.restore()}y.helpers.isMobile()&&A&&y.markers.remove()}}}function w(e){if(E(e[0].nextSibling).data("tracking")){for(;E(e[0].nextSibling).data("tracking")&&(!(0<E(e[0].previousElementSibling).find("[data-tracking-deleted=true]").length&&0<E(e[0].nextElementSibling).find("[data-tracking-deleted=true]").length)||E(e[0].previousSibling).data("tracking"));)E(e).insertAfter(e.next());e.insertBefore(e[0].previousSibling)}}function L(e,t){if(e){for(;e.nodeType===Node.COMMENT_NODE;)e=e.nextSibling;if(E(e).parent().is("table")&&0!==E(e).parent().next().text().length&&L(E(e).parent().next()[0],t),"TD"!==e.tagName||1!==e.childNodes.length||"BR"!==e.childNodes[0].tagName){if(y.node.isBlock(e)&&"HR"!==e.tagName)return y.node.hasClass(e.firstChild,"fr-marker")?L(e.firstChild.nextSibling,t):L(e.firstChild,t),!1;var a="pending-".concat(y.id,"-").concat(y.track_changes.getPendingChanges().length),n=y.opts.showChangesEnabled?'class="fr-highlight-change"':"",r=E('<span data-tracking="true" data-track-id="'.concat(a,'" ').concat(n,"></span>")),i=E('<span data-tracking-deleted="true" class="fr-tracking-deleted" contenteditable="false"></span>');y.opts.showChangesEnabled||i.addClass("fr-track-hide");var s=e;for(E(e).before(r),y.track_changes.pushChange(a);s&&E(s).hasClass("fr-marker");)s=s.nextSibling;for(var l=!1;s&&!l&&!E(s).hasClass("fr-marker")&&0===E(s).find("fr-marker").length&&"UL"!==s.tagName&&"OL"!==s.tagName;){var o=s;if(y.node.isBlock(s)&&"HR"!==e.tagName)return L(s.firstChild,t),!1;if(s)for(var c=s.childNodes,g=0;g<c.length;g++)if(c[g].className&&"fr-marker"===c[g].className){l=!0,L(s.firstChild,t);break}l||(s=s.nextSibling,E(i).append(o))}if(!s||"UL"!==s.tagName&&"OL"!==s.tagName||L(s,t),E(r).prepend(i),y.browser.msie?E(r).prepend("".concat(O.INVISIBLE_SPACE+O.MARKERS)):E(r).prepend("".concat(O.INVISIBLE_SPACE)),E(r).append("".concat(O.INVISIBLE_SPACE+O.MARKERS)),!s&&!e.isSameNode(t)){for(var d=r.get(0).parentNode;d&&!d.nextSibling&&!y.node.isElement(d);)d=d.parentNode;if(d){var h=d.nextSibling;h&&(y.node.isBlock(h)?"HR"===h.tagName?L(h.nextSibling,t):L(h.firstChild,t):L(h,t))}}}}}function f(e){if(y.opts.trackChangesEnabled){y.selection.restore();var t=y.selection.ranges(0).startContainer,a=E(t).parentsUntil(y.$el,"[data-tracking=true]");if(E(t).data("tracking"))return;if(!a.length&&!y.selection.isCollapsed()&&"quote"!=e){y.selection.save(),p(y.$el.find('.fr-marker[data-type="true"]').length&&y.$el.find('.fr-marker[data-type="true"]').get(0),y.$el.find('.fr-marker[data-type="false"]').length&&y.$el.find('.fr-marker[data-type="false"]').get(0));var n=y.$el.find('.fr-marker[data-type="true"]').length&&y.$el.find('.fr-marker[data-type="true"]').get(0),r=n.parentNode;if(r&&"A"===r.tagName&&r.firstChild&&"SPAN"===r.firstChild.tagName&&2<r.firstChild.childNodes.length&&"STRONG"===r.firstChild.childNodes[3].tagName)E(r.firstChild.childNodes[3].firstChild).before(n);else{for(var i=n.previousSibling.firstChild;i&&"SPAN"!==i.tagName;)i=i.nextSibling;E(i).after(n)}y.selection.restore()}}}function p(e,t,a){if(e&&!("<br>"===E(e).html()&&E(e).parent().is("td")||(E(e).parent().is("table")&&0!==E(e).parent().next().text().length&&p(E(e).parent().next()[0],t,a),E(e).is("br")&&E(e).parent().length&&E(e).parent().is("td")&&0===E(e).parent().text().length))){for(a||(a="pending-".concat(y.id,"-").concat(y.track_changes.getPendingChanges().length),y.track_changes.pushChange(a));e.nodeType===Node.COMMENT_NODE;)e=e.nextSibling;if(y.node.isBlock(e)&&"HR"!==e.tagName)return y.node.hasClass(e.firstChild,"fr-marker")?p(e.firstChild.nextSibling,t,a):p(e.firstChild,t,a),!1;var n=y.opts.showChangesEnabled?'class="fr-highlight-change"':"",r=E('<span data-tracking="true" data-track-id="'.concat(a,'" ').concat(n,"></span>")),i=E('<span data-tracking-deleted="true" class="fr-tracking-deleted" contenteditable="false" style="display:none"></span>'),s=e;for(E(e).before(r);s&&E(s).hasClass("fr-marker");)s=s.nextSibling;for(var l=!1;s&&!l&&!E(s).hasClass("fr-marker")&&0===E(s).find("fr-marker").length&&"UL"!==s.tagName&&"OL"!==s.tagName;){var o=s;if(y.node.isBlock(s)&&"HR"!==e.tagName)return p(s.firstChild,t,a),!1;if(s)for(var c=s.childNodes,g=0;g<c.length;g++)if(c[g].className&&"fr-marker"===c[g].className){l=!0,p(s.firstChild,t,a);break}l||(s=s.nextSibling,E(i).append(o.cloneNode(!0)),E(r).append(o))}if(!s||"UL"!==s.tagName&&"OL"!==s.tagName||p(s,t,a),E(s).hasClass("fr-marker")&&E(r).append(s),E(r).prepend(i),E(r).prepend("".concat(O.INVISIBLE_SPACE)),E(r).append("".concat(O.INVISIBLE_SPACE)),!s&&!e.isSameNode(t)){for(var d=r.get(0).parentNode;d&&!d.nextSibling&&!y.node.isElement(d);)d=d.parentNode;if(d){var h=d.nextSibling;h&&(y.node.isBlock(h)?"HR"===h.tagName?p(h.nextSibling,t,a):p(h.firstChild,t,a):p(h,t,a))}}}}function s(e,t,a){var n=y.opts.showChangesEnabled?'class="fr-highlight-change"':"",r=E('<span data-tracking="true" data-track-id="'.concat(a,'" ').concat(n,"></span>")),i=E('<span data-tracking-deleted="true" class="fr-tracking-deleted" contenteditable="false"></span>');y.opts.showChangesEnabled||i.addClass("fr-track-hide"),i.append(t.get(0).innerHTML),r.append(i);var s=e.get(0).innerHTML;e.html(""),e.append(r),r.append(s)}function u(){if(y.events.trigger("image.hideResizer"),y.events.trigger("video.hideResizer"),y.html.cleanEmptyTags(),y.helpers.isMobile())for(var e=y.$el.find("img[data-tracking-img]"),t=0;t<e.length;t++){var a=E(e.get(t));a.parent()&&a.parent().data("tracking")||a.removeData("tracking-img")}}function e(){var e=c();if(e){var t=y.$el.find("[data-track-id=".concat(e,"]"));if(t.length)for(var a=0;a<t.length;a++){var n=E(t).data("tracking-deleted")?E(t):E(t.get(a)).find("[data-tracking-deleted=true]");if(n.length)if(0<E(t).find("IFRAME").length)E(t).removeData("tracking"),E(t).removeData("track-id"),E(t).removeClass("fr-highlight-change"),E(t).removeClass("fr-tracking-deleted"),E(t).removeData("tracking-deleted"),E(t).removeAttr("contenteditable");else n.parent("[data-tracking=true]").data("track-id")==e?t.get(a).outerHTML=n.get(0).innerHTML:t.get(a).remove?t.get(a).remove():t.get(a).parentNode.removeChild(t.get(a));else t.get(a).remove?t.get(a).remove():t.get(a).parentNode.removeChild(t.get(a))}}u()}return y.events.on("keydown",function(e){if(!y.opts.trackChangesEnabled)return!0;if(y.helpers.isMobile())A=y.selection.get().focusNode.nodeValue,_=y.selection.get().focusNode,M=_.nextSibling,x=y.selection.get().focusOffset;else if(function t(e){return(!y.keys.ctrlKey(e)||e.which!==O.KEYCODE.Z&&e.which!==O.KEYCODE.C)&&(48<=e.keyCode&&e.keyCode<=57||65<=e.keyCode&&e.keyCode<=90||97<=e.keyCode&&e.keyCode<=122||186<=e.keyCode&&e.keyCode<=222||13===e.keyCode||8===e.keyCode||32===e.keyCode||46===e.keyCode||96<=e.keyCode&&e.keyCode<=111)}(e))if(!y.keys.ctrlKey(e)||"b"!==e.key&&"i"!==e.key&&"u"!==e.key){if(y.keys.ctrlKey(e)&&"a"===e.key||y.keys.ctrlKey(e)&&"s"===e.key)return;h(e)}else f()},!0),y.events.on("keyup",function(e){if(!y.opts.trackChangesEnabled)return!0;if(y.helpers.isMobile()){if(function s(e){if(y.opts.trackChangesEnabled){var t=y.selection.get(),a=t.focusNode,n=a&&a.nodeValue?a.nodeValue:"",r=t.focusOffset-1,i=t.rangeCount;_&&_.isSameNode(a)&&A.length>n.length?(e.keyCode=8,e.selectionLength=A.length-n.length):!_||_.isSameNode(a)||_.nextSibling||_.previousSibling?e.keyCode=n.substr(r,i).charCodeAt(0):(e.keyCode=8,e.selectionLength=A.length)}}(e),46===e.keyCode)return!0;h(e)}},!0),y.events.on("paste.before",function(e){y.opts.trackChangesEnabled&&y.helpers.isMobile()&&h(e)},!0),y.events.on("image.inserted",function(e){y.helpers.isMobile()&&y.opts.trackChangesEnabled&&e.data("tracking-img",!0)}),y.events.on("image.removed",function(e){if(y.helpers.isMobile()&&y.opts.trackChangesEnabled&&!e.data("tracking-img")&&!e.parent().data("tracking")){var t=y.selection.ranges(0).startContainer,a=E(t).parentsUntil(y.$el,"[data-tracking=true]");y.markers.insert();var n=y.$el.find(".fr-marker"),r="pending-".concat(y.id,"-").concat(y.track_changes.getPendingChanges().length),i=y.opts.showChangesEnabled?'class="fr-highlight-change"':"",s=E('<span data-tracking="true" data-track-id="'.concat(r,'" ').concat(i,"></span>")),l=E('<span data-tracking-deleted="true" class="fr-tracking-deleted" contenteditable="false"></span>');y.opts.showChangesEnabled||l.addClass("fr-track-hide"),e.data("tracking-img",!0),E(t).data("tracking")||a.length?(E(n).replaceWith(l),E(l).append(e),y.markers.remove()):(E(n).replaceWith(s),E(s).prepend(l),E(l).append(e),y.markers.remove(),y.track_changes.pushChange(r))}}),y.events.on("commands.before",function(t){if(!y.opts.trackChangesEnabled)return!0;var e=["applytextColor","bold","italic","underline","strikeThrough","subscript","superscript","fontFamily","fontSize","textColor","backgroundColor","inlineClass","inlineStyle","alignLeft","alignCenter","formatOLSimple","alignRight","alignJustify","formatOL","formatUL","paragraphFormat","paragraphStyle","lineHeight","outdent","indent","quote"];if(["change","applyLast","removeLast","showChanges","trackChanges","moreTrackChanges","undo","redo","fullscreen","print","getPDF","spellChecker","selectAll","html","help"].filter(function(e){return e===t}).length||e.filter(function(e){return e===t}).length){if(e.filter(function(e){return e===t}).length&&"paragraphFormat"!==t&&"paragraphStyle"!==t&&"lineHeight"!==t)f(t);else if("paragraphFormat"===t||"paragraphStyle"===t||"lineHeight"===t){y.selection.save();var a=y.$el.find('.fr-marker[data-type="true"]').length&&y.$el.find('.fr-marker[data-type="true"]').get(0),n=y.opts.showChangesEnabled?'class="fr-highlight-change"':"",r="pending-".concat(y.id,"-").concat(y.track_changes.getPendingChanges().length),i=E('<span data-tracking="true" data-track-id="'.concat(r,'" ').concat(n,"></span>")),s=E('<span data-tracking-deleted="true" class="fr-tracking-deleted" contenteditable="false" style="display:none"></span>'),l=a.parentNode.cloneNode(!0);l.firstChild.remove(),l.lastChild.remove(),E(s).append(l),E(i).append(s),E(a.parentNode).after(E("<p></p>")),E(a.parentNode.nextSibling).append(i),i=E('<span data-tracking="true" data-track-id="'.concat(r,'" ').concat(n,"></span>")),E(a.parentNode.nextSibling).after(E("<p></p>")),E(a.parentNode.nextSibling.nextSibling).append(i),i.append(a.parentNode),y.track_changes.pushChange(r),y.selection.restore()}}else{if(O.COMMANDS[t]&&(O.COMMANDS[t].hasOwnProperty("type")&&"dropdown"===O.COMMANDS[t].type||O.COMMANDS[t].more_btn||O.COMMANDS[t].popup)){if("insertImage"!=t&&"insertFile"!=t)return}else if("clearFormatting"===t)return void(y.opts.trackChangesEnabled&&function(){d=y.selection.blocks();for(var a=[],n=0,e=0;e<d.length;e++){n=e<n?n:e;var t=E(d[e]);if(t.is("li"))t.siblings("li").each(function(e,t){E(t).find("li").length&&(a.push({index:n,item:t}),n+=1)});g[e]=E("<span>".concat(t.get(0).innerHTML,"</span>"))}for(var r=0,i=a;r<i.length;r++){var s=i[r],l=s.index,o=s.item,c=E(E(o).get(0).outerHTML);c.find("ul").remove(),c.find("ol").remove(),g=[].concat(V(g.slice(0,l+1)),[E("<span>".concat(c.get(0).innerHTML,"</span>"))],V(g.slice(l+1))),d=[].concat(V(d.slice(0,l+1)),[o],V(d.slice(l+1)))}}());h()}},!0),y.events.on("commands.after",function(e){if(!y.opts.trackChangesEnabled)return!0;if(0<=["undo","redo"].indexOf(e))!function r(){var e=y.$el.find("[data-tracking=true]");o.splice(0,o.length);for(var t=0;t<e.length;t++){var a=E(e.get(t)).data("track-id");o[a.slice(a.lastIndexOf("-")+1)]=a}}();else if("clearFormatting"==e&&y.opts.trackChangesEnabled){var t="pending-".concat(y.id,"-").concat(y.track_changes.getPendingChanges().length);for(var a in d){var n=E(d[a]);g[a]&&(s(n,g[a],t),g[a]=null,i[a]=null)}y.track_changes.pushChange(t),g=[],d=null}},!0),{toggleTracking:function t(){y.opts.trackChangesEnabled&&-1<y.html.get(!0,!0).indexOf("data-tracking")?alert("Your editor has pending changes. Please resolve them before turning off Track Changes in the toolbar."):(y.commands.moreTrackChanges(),y.opts.trackChangesEnabled=!y.opts.trackChangesEnabled,y.opts.trackChangesEnabled||(y.opts.showChangesEnabled=!1))},pushChange:function a(e){o.push(e)},insertChangeAt:function n(e,t){o=[].concat(V(o.slice(0,e)),[t],V(o.slice(e)))},popChange:c,getPendingChanges:function r(){return o},showChanges:function l(){if(y.opts.showChangesEnabled=!y.opts.showChangesEnabled,function r(e,t){for(var a=0;a<e.length;a++)t?E(e.get(a)).removeClass("fr-track-hide"):E(e.get(a)).addClass("fr-track-hide")}(y.$el.find(".fr-tracking-deleted"),y.opts.showChangesEnabled),y.opts.showChangesEnabled)for(var e=y.$el.find("[data-tracking=true]").not(".fr-highlight-change"),t=0;t<e.length;t++)E(e.get(t)).addClass("fr-highlight-change");else for(var a=y.$el.find(".fr-highlight-change"),n=0;n<a.length;n++)E(a.get(n)).removeClass("fr-highlight-change")},acceptAllChanges:function k(){for(var e=0;e<o.length;e++){var t=void 0,a=y.$el.find("[data-track-id=".concat(o[e],"]"));if(a.length){var n=a.parent("a");if(n.length){var r=n.text();1===[].filter.call(r,function(e){return 8203!==e.charCodeAt(0)}).length&&(t=n)}for(var i=0;i<a.length;i++){var s=a.get(i),l=E(a).data("tracking-deleted")?E(a):E(s).find("[data-tracking-deleted=true]");l.length&&(l.get(0).remove?l.get(0).remove():l.get(0).parentNode.removeChild(l.get(0))),s.hasAttribute("style")?(E(s).removeData("tracking"),E(s).removeData("track-id"),E(s).removeClass("fr-highlight-change")):(y.selection.save(),0<E(s).find("IFRAME").length?(E(s).removeData("tracking"),E(s).removeData("track-id"),E(s).removeClass("fr-highlight-change")):s.outerHTML=s.innerHTML,y.selection.restore())}}t&&t.remove()}o=[],u()},rejectAllChanges:function C(){for(;0!=y.track_changes.getPendingChanges().length;)e();o=[]},acceptSingleChange:function m(){var e=c();if(e){var t,a=y.$el.find("[data-track-id=".concat(e,"]"));if(a.length){var n=a.parent("a");if(n.length){var r=E(n.get(0).outerHTML).text();1===[].filter.call(r,function(e){return 8203!==e.charCodeAt(0)}).length&&(t=n)}for(var i=0;i<a.length;i++){var s=a.get(i),l=E(a).data("tracking-deleted")?E(a):E(s).find("[data-tracking-deleted=true]");l.length&&(l.get(0).remove?l.get(0).remove():l.get(0).parentNode.removeChild(l.get(0))),s.hasAttribute("style")?(E(s).removeData("tracking"),E(s).removeData("track-id"),E(s).removeClass("fr-highlight-change")):(y.selection.save(),0<E(s).find("IFRAME").length?(E(s).removeData("tracking"),E(s).removeData("track-id"),E(s).removeClass("fr-highlight-change")):s.outerHTML=s.innerHTML,y.selection.restore())}}t&&t.remove()}u()},rejectSingleChange:e,refresh:function b(e){var t=y.$el.find("[data-tracking=true]");e.toggleClass("fr-disabled",!o.length),e.toggleClass("fr-active",o.length).attr("aria-pressed",o.length),0<!t.length&&(e.removeClass("fr-active"),e.addClass("fr-disabled"));var a=y.$tb.find('.fr-command[data-cmd="markdown"]');a&&y.opts.trackChangesEnabled?a.addClass("fr-disabled"):a&&a.removeClass("fr-disabled")},replaceSpecialItem:function v(e){y.selection.setBefore(e.get(0)),y.selection.setAfter(e.get(0)),p(y.$el.find('.fr-marker[data-type="true"]').length&&y.$el.find('.fr-marker[data-type="true"]').get(0),y.$el.find('.fr-marker[data-type="false"]').length&&y.$el.find('.fr-marker[data-type="false"]').get(0))},removeSpecialItem:function S(e){y.selection.setBefore(e.get(0)),y.selection.setAfter(e.get(0)),L(y.$el.find('.fr-marker[data-type="true"]').length&&y.$el.find('.fr-marker[data-type="true"]').get(0),y.$el.find('.fr-marker[data-type="false"]').length&&y.$el.find('.fr-marker[data-type="false"]').get(0))},removedTable:function N(e){var t="pending-".concat(y.id,"-").concat(y.track_changes.getPendingChanges().length),a=y.opts.showChangesEnabled?'class="fr-highlight-change"':"",n=E('<span data-tracking="true" data-track-id="'.concat(t,'" ').concat(a,"></span>")),r=E('<span data-tracking-deleted="true" class="fr-tracking-deleted" contenteditable="false"></span>');e.before(n),r.append(e),n.append(r),y.track_changes.pushChange(t)},addQuote:function I(e){var t="pending-".concat(y.id,"-").concat(y.track_changes.getPendingChanges().length),a=y.opts.showChangesEnabled?'class="fr-highlight-change"':"",n=E('<div data-tracking="true" data-track-id="'.concat(t,'" ').concat(a,"></div>")),r=E('<div data-tracking="true" data-track-id="'.concat(t,'" ').concat(a,"></div>")),i=E('<span data-tracking-deleted="true" class="fr-tracking-deleted" contenteditable="false"></span>');y.opts.showChangesEnabled||i.addClass("fr-track-hide"),e.before(r),e.before(n);var s=e.get(0).innerHTML;i.append(s),n.append(i),r.append(e),r.find('[data-tracking="true"]').each(function(e,t){E(t).children().eq(0).insertBefore(E(t)),E(t).remove()}),y.track_changes.pushChange(t)},removeQuote:function P(e,t){if(!(0<t)){var a="pending-".concat(y.id,"-").concat(y.track_changes.getPendingChanges().length),n=y.opts.showChangesEnabled?'class="fr-highlight-change"':"",r=E('<div data-tracking="true" data-track-id="'.concat(a,'" ').concat(n,"></div>")),i=E('<div data-tracking="true" data-track-id="'.concat(a,'" ').concat(n,"></div>")),s=E('<span data-tracking-deleted="true" class="fr-tracking-deleted" contenteditable="false"></span>');y.opts.showChangesEnabled||s.addClass("fr-track-hide"),e.before(i),e.before(r);var l=e.find("blockQuote").eq(0).html();l||(l=e.html()),s.append(e),r.append(s),i.append(l),i.find('[data-tracking="true"]').each(function(e,t){E(t).children().eq(0).insertBefore(E(t)),E(t).remove()}),y.track_changes.pushChange(a)}},wrapInTracking:function R(e,t){var a="pending-".concat(y.id,"-").concat(y.track_changes.getPendingChanges().length),n=y.opts.showChangesEnabled?'class="fr-highlight-change"':"",r=E('<span data-tracking="true" data-track-id="'.concat(a,'" ').concat(n,"></span>"));t&&r.addClass(t);var i=E('<span data-tracking-deleted="true" class="fr-tracking-deleted" contenteditable="false"></span>');return y.opts.showChangesEnabled||i.addClass("fr-track-hide"),e.before(r),r.append(e),y.track_changes.pushChange(a),r},wrapInDelete:function T(e){var t=E('<span data-tracking-deleted="true" class="fr-tracking-deleted" contenteditable="false"></span>');return y.opts.showChangesEnabled||t.addClass("fr-track-hide"),t.append(e),t},wrapLinkInTracking:function $(e,t){var a="pending-".concat(y.id,"-").concat(y.track_changes.getPendingChanges().length),n=y.opts.showChangesEnabled?'class="fr-highlight-change"':"",r=E('<span data-tracking="true" data-track-id="'.concat(a,'" ').concat(n,"></span>"));return e.before(r),r.append(e),y.track_changes.insertChangeAt(t-1,a),r}}},O.DefineIcon("trackChanges",{NAME:"enable-tracking",SVG_KEY:"trackChanges"}),O.DefineIcon("showChanges",{NAME:"show-changes",SVG_KEY:"showTrackChanges"}),O.DefineIcon("applyAll",{NAME:"apply-all",SVG_KEY:"acceptAllChanges"}),O.DefineIcon("removeAll",{NAME:"remove-all",SVG_KEY:"rejectAllChanges"}),O.DefineIcon("applyLast",{NAME:"apply-last",SVG_KEY:"acceptSingleChange"}),O.DefineIcon("removeLast",{NAME:"remove-last",SVG_KEY:"rejectSingleChange"}),O.RegisterCommand("trackChanges",{type:"button",title:"Enable Track Changes",plugin:"track_changes",showOnMobile:!0,callback:function(){this.track_changes.toggleTracking()},refreshAfterCallback:!0,forcedRefresh:!0,refresh:function(e){e.toggleClass("fr-active",this.opts.trackChangesEnabled).attr("aria-pressed",this.opts.trackChangesEnabled)}}),O.RegisterCommand("showChanges",{type:"button",icon:"showChanges",title:"Show Changes",plugin:"track_changes",undo:!1,focus:!1,accessibilityFocus:!0,forcedRefresh:!0,refreshAfterCallback:!0,toggle:!0,callback:function(){this.track_changes.showChanges()},refresh:function(e){e.toggleClass("fr-active",this.opts.showChangesEnabled).attr("aria-pressed",this.opts.showChangesEnabled)}}),O.RegisterCommand("applyAll",{type:"button",icon:"applyAll",title:"Accept All Changes",plugin:"track_changes",toggle:!0,refreshAfterCallback:!0,forcedRefresh:!0,callback:function(){0<this.track_changes.getPendingChanges().length&&this.track_changes.acceptAllChanges()},refresh:function(e){this.track_changes.refresh(e)}}),O.RegisterCommand("removeAll",{type:"button",icon:"removeAll",title:"Reject All Changes",plugin:"track_changes",toggle:!0,refreshAfterCallback:!0,forcedRefresh:!0,callback:function(){0<this.track_changes.getPendingChanges().length&&this.track_changes.rejectAllChanges()},refresh:function(e){this.track_changes.refresh(e)}}),O.RegisterCommand("applyLast",{type:"button",icon:"applyLast",title:"Accept Single Change",plugin:"track_changes",toggle:!0,refreshAfterCallback:!0,forcedRefresh:!0,callback:function(){0<this.track_changes.getPendingChanges().length&&this.track_changes.acceptSingleChange()},refresh:function(e){this.track_changes.refresh(e)}}),O.RegisterCommand("removeLast",{type:"button",icon:"removeLast",title:"Reject Single Change",plugin:"track_changes",toggle:!0,refreshAfterCallback:!0,forcedRefresh:!0,callback:function(){0<this.track_changes.getPendingChanges().length&&this.track_changes.rejectSingleChange()},refresh:function(e){this.track_changes.refresh(e)}})});